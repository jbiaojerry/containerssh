<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://projects.pasztor.at/containerssh/hardening/">
  <link rel="shortcut icon" href="../img/favicon.png">
  
  <title>Hardening - ContainerSSH: An SSH Server That Launches Containers</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../css/custom.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Hardening";
    var mkdocs_page_input_path = "hardening.md";
    var mkdocs_page_url = "/containerssh/hardening/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:site_name" content="ContainerSSH: An SSH Server that Launches Containers" />
<meta property="og:title" content="Hardening"/>
<meta property="og:image" content="https://projects.pasztor.at/containerssh/img/opengraph.png" />
<meta property="og:url" content="https://projects.pasztor.at/containerssh/hardening/" />
<meta property="og:description" content="ContainerSSH is an SSH server that launches containers in Docker and Kubernetes." />

<link rel="apple-touch-icon-precomposed" href="https://projects.pasztor.at/containerssh/img/tileicon.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="ContainerSSH is an SSH server that launches containers in Docker and Kubernetes." />
<meta name="twitter:site" content="@janoszen" />
<meta name="twitter:title" content="ContainerSSH" />
<meta name="twitter:image" content="https://projects.pasztor.at/containerssh/img/opengraph.png" />
<meta name="theme-color" content="#da291c" />
<meta name="msapplication-navbutton-color" content="#da291c" />
<meta name="application-name" content="ContainerSSH" />
<meta name="msapplication-starturl" content="/" />
<meta name="HandheldFriendly" content="true" />
<meta name="msapplication-TileImage" content="https://projects.pasztor.at/containerssh/img/tileicon.png' | url }}" />

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> ContainerSSH: An SSH Server That Launches Containers</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../quickstart/">Quick Start</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../configuration/">Configuration</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../authserver/">Authentication Server</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../configserver/">Configuration Server</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../backends/">Selecting a Backend</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../dockerrun/">The dockerrun Backend</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../kuberun/">The kuberun Backend</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../image/">Creating an Image</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Hardening</a>
    <ul class="current">
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../faq/">FAQ</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API reference</span></p>
                <ul>
                    <li class="toctree-l1"><a class="" href="../api/authconfig/">The AuthConfig Server â­§</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">ContainerSSH: An SSH Server That Launches Containers</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Hardening</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/janoszen/containerssh/edit/stable/docs/hardening.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1>Hardening ContainerSSH</h1>

<p>ContainerSSH is built to secure its inner workings as much as possible. You can take several steps to secure it further.</p>
<h2 id="running-containerssh">Running ContainerSSH<a class="headerlink" href="#running-containerssh" title="Permanent link">&para;</a></h2>
<p>The default <a href="https://hub.docker.com/r/janoszen/containerssh">ContainerSSH image</a> runs as a non-root user by default
and exposes itself on port 2222. If you decide to build your own installation make sure ContainerSSH does not run
as root as it is not required.</p>
<h2 id="secure-your-dockerkubernetes">Secure your Docker/Kubernetes<a class="headerlink" href="#secure-your-dockerkubernetes" title="Permanent link">&para;</a></h2>
<p>Depending on which backend you are using you have to take different steps to secure it.</p>
<p>When using Docker ContainerSSH will need access to the Docker socket. This undeniably means that ContainerSSH will
be able to launch root processes on the host machine. You may want to look into running Docker in
<a href="https://docs.docker.com/engine/security/rootless/">rootless mode</a> or switching to <a href="https://podman.io/">Podman</a></p>
<p>When running Kubernetes it is strongly advised that you deploy a pod security policy and a network policy. You should
also make sure that ContainerSSH uses a restricted service account that can only access its own namespace.</p>
<h2 id="securing-your-auth-server">Securing your auth server<a class="headerlink" href="#securing-your-auth-server" title="Permanent link">&para;</a></h2>
<p>Your authentication server contains all your secrets and is therefore a prime target. ContainerSSH delegates any and
all access checking to the authentication server so you should make sure it prevents brute force attacks.</p>
<p>Furthermore, you should make sure that the authentication server cannot be accessed from anywhere else. You can do this
using firewalls, or alternatively you can configure ContainerSSH to use client certificates to authenticate itself:</p>
<pre><code class="yaml">auth:
    url: http://127.0.0.1:8080
    cacert: &quot;insert your expected CA certificate in PEM format here&quot;
    timeout: 2s
    cert: &quot;insert your client certificate in PEM format here&quot;
    key: &quot;insert your client key in PEM format here&quot;
</code></pre>

<h2 id="securing-your-config-server">Securing your config server<a class="headerlink" href="#securing-your-config-server" title="Permanent link">&para;</a></h2>
<p>Similar to your authentication server you can also secure the config server in a similar manner:</p>
<pre><code class="yaml">configserver:
    timeout: 2s
    url: http://127.0.0.1:8080/config
    cacert: &quot;insert your expected CA certificate in PEM format here&quot;
    cert: &quot;insert your client certificate in PEM format here&quot;
    key: &quot;insert your client key in PEM format here&quot;
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../faq/" class="btn btn-neutral float-right" title="FAQ">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../image/" class="btn btn-neutral" title="Creating an Image"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; Janos Pasztor and Contributors | <a href="https://projects.pasztor.at/containerssh/privacy/">Privacy Policy</a></p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/janoszen/containerssh/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../image/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../faq/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
